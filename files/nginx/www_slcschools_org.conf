upstream www_slcschools_org {
  server unix:/var/run/gunicorn/gunicorn_www_slcschools_org.sock fail_timeout=10s;
}
ssl_certificate /etc/pki/tls/certs/star_slcschools_org.crt;
ssl_certificate_key /etc/pki/tls/private/star_slcschools_org.key;
ssl_trusted_certificate /etc/pki/ca-trust/source/anchors/DigiCertCA.crt;
server {
  listen 80;
  listen 443 ssl;
  server_name www.slcschools.org www-dev.slcschools.org www-testing.slcschools.org www2.slcschools.org;
  client_max_body_size 4G;

  location / {
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header Host $http_host;
    proxy_redirect off;
    if (!-f $request_filename) {
      proxy_pass http://www_slcschools_org;
      break;
    }
  }
  location ~ \.(jpg|jpeg|gif|png|svg|pdf|css|woff2|woff|ttf|js) {
    root /srv/nginx/www_slcschools_org/;
  }
}
